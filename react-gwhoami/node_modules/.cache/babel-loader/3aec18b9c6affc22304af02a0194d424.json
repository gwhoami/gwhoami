{"ast":null,"code":"var _jsxFileName = \"D:\\\\Git-Repo\\\\gwhoami\\\\react-gwhoami\\\\src\\\\container\\\\login.js\",\n    _s = $RefreshSig$();\n\nimport { faEnvelope, faEye, faEyeSlash, faLock } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport React, { useContext, useRef, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { Link } from \"react-router-dom\";\nimport { apiGetCall } from \"../helper/API\";\nimport MyLocalStorage from \"../helper/mylocalStorage\";\nimport ToastMessage from \"../toast\";\nimport { MenuContext } from \"../util/maincontext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst LoginPage = /*#__PURE__*/_s( /*#__PURE__*/React.memo(_c = _s(() => {\n  _s();\n\n  const {\n    goTo\n  } = useContext(MenuContext);\n  const history = useHistory();\n  const [, uiRefresh] = useState(-1);\n  const passRef = useRef(null);\n  const formData = useRef({\n    username: '',\n    password: '',\n    isEyeToggle: false,\n    isLoading: false\n  });\n\n  const setFormValue = (e, key) => {\n    formData.current[key] = e.currentTarget.value;\n    uiRefresh(Date.now());\n  };\n\n  const makeLogin = () => {\n    formData.current.isLoading = true;\n    uiRefresh(Date.now());\n    const isEmail = new RegExp('[a-z0-9]+@[a-z]+\\\\.[a-z]{2,3}').test(formData.current.username);\n\n    (async () => {\n      const res = await apiGetCall(`/api/user/${isEmail ? 'logincheck' : 'adminlogincheck'}`, {\n        username: formData.current.username,\n        password: formData.current.password\n      });\n\n      if (res.isError) {\n        var _res$Error$response, _res$Error$response$d;\n\n        let msg = ((_res$Error$response = res.Error.response) === null || _res$Error$response === void 0 ? void 0 : (_res$Error$response$d = _res$Error$response.data) === null || _res$Error$response$d === void 0 ? void 0 : _res$Error$response$d.success) || false;\n\n        if (!msg) {\n          ToastMessage({\n            type: \"error\",\n            message: \"Invalid username or password\",\n            timeout: 1500\n          });\n        } else ToastMessage({\n          type: \"error\",\n          message: res.Error.stack,\n          timeout: 1500\n        });\n\n        formData.current.isLoading = false;\n        uiRefresh(Date.now());\n      } else {\n        MyLocalStorage.setLoginInfo(res);\n        if (!isEmail) history.push('/admin/users');else history.push('/home/login');\n      }\n    })();\n  };\n\n  const toggleEye = () => {\n    formData.current.isEyeToggle = !formData.current.isEyeToggle;\n    uiRefresh(Date.now());\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col my-20\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container max-w-md mx-auto flex-1 flex flex-col items-center justify-center px-2\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white px-6 py-8 rounded-xl shadow-md text-black w-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"mb-8 text-3xl text-left\",\n          children: \"Sign In\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative text-gray-700 mb-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"w-full h-10 pl-9 pr-3 text-base placeholder-gray-600 border rounded-lg focus:shadow-outline\",\n            type: \"text\",\n            placeholder: \"Email or Phone\",\n            value: formData.current.username,\n            onChange: e => setFormValue(e, 'username')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute inset-y-0 left-1 mt-0.5 flex items-center px-2 pointer-events-none\",\n            children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faEnvelope,\n              className: \"text-xl\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 64,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative text-gray-700 mb-5\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"w-full h-10 pl-9 pr-10 text-base placeholder-gray-600 border rounded-lg focus:shadow-outline\",\n            type: formData.current.isEyeToggle ? \"text\" : \"password\",\n            placeholder: \"password\",\n            value: formData.current.password,\n            ref: passRef,\n            onChange: e => setFormValue(e, 'password')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute inset-y-0 left-1 mt-0.5 flex items-center px-2 pointer-events-none\",\n            children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faLock,\n              className: \"text-xl\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute inset-y-0 right-0 flex items-center px-2\",\n            children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: formData.current.isEyeToggle ? faEyeSlash : faEye,\n              className: \"text-xl opacity-50 hover:opacity-100 hover:cursor-pointer\",\n              onClick: toggleEye\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-5\",\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/home/verifyemail\",\n            className: \"text-dodge-b font-bold\",\n            children: \"Forgot Password/Username\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-center mb-5\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"h-14 px-32 m-2 text-indigo-100 transition-colors duration-150 bg-dodge-b rounded-full shadow-md shadow-gray-500 focus:shadow-outline hover:bg-dodge-d\",\n            onClick: makeLogin,\n            children: formData.current.isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-12 flex justify-center\",\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"animate-spin -ml-1 mr-3 h-5 w-5 text-white\",\n                xmlns: \"http://www.w3.org/2000/svg\",\n                fill: \"none\",\n                viewBox: \"0 0 24 24\",\n                children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n                  className: \"opacity-25\",\n                  cx: \"12\",\n                  cy: \"12\",\n                  r: \"10\",\n                  stroke: \"currentColor\",\n                  strokeWidth: \"4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 93,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                  className: \"opacity-75\",\n                  fill: \"currentColor\",\n                  d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 94,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 92,\n                columnNumber: 75\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 33\n            }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: \"Sign In\"\n            }, void 0, false)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-2 text-center font-bold\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"New to whoami? \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/home/signin\",\n            onClick: _ => goTo(3),\n            className: \"text-dodge-b\",\n            children: \"Register here\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 53\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 9\n  }, this);\n}, \"zabaClO8bgpRZg7ZRjznIjjj1MM=\", false, function () {\n  return [useHistory];\n})), \"zabaClO8bgpRZg7ZRjznIjjj1MM=\", false, function () {\n  return [useHistory];\n});\n\n_c2 = LoginPage;\nexport default LoginPage;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"LoginPage$React.memo\");\n$RefreshReg$(_c2, \"LoginPage\");","map":{"version":3,"sources":["D:/Git-Repo/gwhoami/react-gwhoami/src/container/login.js"],"names":["faEnvelope","faEye","faEyeSlash","faLock","FontAwesomeIcon","React","useContext","useRef","useState","useHistory","Link","apiGetCall","MyLocalStorage","ToastMessage","MenuContext","LoginPage","memo","goTo","history","uiRefresh","passRef","formData","username","password","isEyeToggle","isLoading","setFormValue","e","key","current","currentTarget","value","Date","now","makeLogin","isEmail","RegExp","test","res","isError","msg","Error","response","data","success","type","message","timeout","stack","setLoginInfo","push","toggleEye","_"],"mappings":"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","sourcesContent":["import { faEnvelope, faEye, faEyeSlash, faLock } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport React, { useContext, useRef, useState } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { apiGetCall } from \"../helper/API\";\r\nimport MyLocalStorage from \"../helper/mylocalStorage\";\r\nimport ToastMessage from \"../toast\";\r\nimport { MenuContext } from \"../util/maincontext\";\r\n\r\nconst LoginPage = React.memo(() => {\r\n    const { goTo } = useContext(MenuContext);\r\n    const history = useHistory();\r\n    const [, uiRefresh] = useState(-1);\r\n    const passRef = useRef(null);\r\n    const formData = useRef({\r\n        username: '',\r\n        password: '',\r\n        isEyeToggle: false,\r\n        isLoading: false\r\n    });\r\n    const setFormValue = (e, key) => {\r\n        formData.current[key] = e.currentTarget.value;\r\n        uiRefresh(Date.now());\r\n    }\r\n    const makeLogin = () => {\r\n        formData.current.isLoading = true;\r\n        uiRefresh(Date.now());\r\n        const isEmail = new RegExp('[a-z0-9]+@[a-z]+\\\\.[a-z]{2,3}').test(formData.current.username);\r\n        (async () => {\r\n            const res = await apiGetCall(`/api/user/${isEmail ? 'logincheck' : 'adminlogincheck'}`, { username: formData.current.username, password: formData.current.password });\r\n            if (res.isError) {\r\n                let msg = res.Error.response?.data?.success || false;\r\n                if (!msg) {\r\n                    ToastMessage({ type: \"error\", message: \"Invalid username or password\", timeout: 1500 });\r\n                } else ToastMessage({ type: \"error\", message: res.Error.stack, timeout: 1500 });\r\n                formData.current.isLoading = false;\r\n                uiRefresh(Date.now());\r\n            } else {\r\n                MyLocalStorage.setLoginInfo(res);\r\n                if (!isEmail) history.push('/admin/users');\r\n                else history.push('/home/login');\r\n            }\r\n        })();\r\n    }\r\n    const toggleEye = () => {\r\n        formData.current.isEyeToggle = !formData.current.isEyeToggle;\r\n        uiRefresh(Date.now());\r\n    }\r\n    return (\r\n        <div className=\"flex flex-col my-20\">\r\n            <div className=\"container max-w-md mx-auto flex-1 flex flex-col items-center justify-center px-2\">\r\n                <div className=\"bg-white px-6 py-8 rounded-xl shadow-md text-black w-full\">\r\n                    <h1 className=\"mb-8 text-3xl text-left\">Sign In</h1>\r\n                    <div className=\"relative text-gray-700 mb-8\">\r\n                        <input\r\n                            className=\"w-full h-10 pl-9 pr-3 text-base placeholder-gray-600 border rounded-lg focus:shadow-outline\"\r\n                            type=\"text\"\r\n                            placeholder=\"Email or Phone\"\r\n                            value={formData.current.username}\r\n                            onChange={e => setFormValue(e, 'username')}\r\n                        />\r\n                        <div className=\"absolute inset-y-0 left-1 mt-0.5 flex items-center px-2 pointer-events-none\">\r\n                            <FontAwesomeIcon icon={faEnvelope} className=\"text-xl\" />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"relative text-gray-700 mb-5\">\r\n                        <input\r\n                            className=\"w-full h-10 pl-9 pr-10 text-base placeholder-gray-600 border rounded-lg focus:shadow-outline\"\r\n                            type={formData.current.isEyeToggle ? \"text\" : \"password\"}\r\n                            placeholder=\"password\"\r\n                            value={formData.current.password}\r\n                            ref={passRef}\r\n                            onChange={e => setFormValue(e, 'password')}\r\n                        />\r\n                        <div className=\"absolute inset-y-0 left-1 mt-0.5 flex items-center px-2 pointer-events-none\">\r\n                            <FontAwesomeIcon icon={faLock} className=\"text-xl\" />\r\n                        </div>\r\n                        <div className=\"absolute inset-y-0 right-0 flex items-center px-2\">\r\n                            <FontAwesomeIcon icon={formData.current.isEyeToggle ? faEyeSlash : faEye} className=\"text-xl opacity-50 hover:opacity-100 hover:cursor-pointer\" onClick={toggleEye} />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"mb-5\">\r\n                        <Link to=\"/home/verifyemail\" className=\"text-dodge-b font-bold\">Forgot Password/Username</Link>\r\n                    </div>\r\n                    <div className=\"flex justify-center mb-5\">\r\n                        <button\r\n                            className=\"h-14 px-32 m-2 text-indigo-100 transition-colors duration-150 bg-dodge-b rounded-full shadow-md shadow-gray-500 focus:shadow-outline hover:bg-dodge-d\"\r\n                            onClick={makeLogin}\r\n                        >\r\n                            {formData.current.isLoading ?\r\n                                <div className=\"w-12 flex justify-center\"><svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                                </svg></div>\r\n                                : <>Sign In</>}\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"mb-2 text-center font-bold\">\r\n                        <span>New to whoami? </span><Link to=\"/home/signin\" onClick={_ => goTo(3)} className=\"text-dodge-b\">Register here</Link>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n\r\nexport default LoginPage;"]},"metadata":{},"sourceType":"module"}